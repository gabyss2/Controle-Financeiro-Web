
import React from "react"; import { View, TextInput, FlatList, Text, Alert } from "react-native"; import { supabase } from "../lib/supabase"; import type { Card } from "../types"; import { Button } from "./UI";
export default function CardEditor() { const [list, setList] = React.useState<Card[]>([]); const [alias, setAlias] = React.useState(""); const [closing, setClosing] = React.useState("15"); const [due, setDue] = React.useState("22"); async function load() { const { data, error } = await supabase.from("cards").select("*").order("alias"); if (error) Alert.alert("Erro", error.message); else setList((data ?? []) as Card[]); }
  async function add() { if (!alias.trim()) return; const closing_day = Math.max(1, Math.min(31, parseInt(closing || "15"))); const due_day = Math.max(1, Math.min(31, parseInt(due || "22"))); const { error } = await supabase.from("cards").insert({ alias: alias.trim(), closing_day, due_day }); if (error) Alert.alert("Erro", error.message); setAlias(""); load(); }
  React.useEffect(() => { load(); }, []);
  return (<View style={{ gap: 10 }}><Text style={{ fontWeight: "700" }}>Cartões</Text><View style={{ gap: 8 }}><TextInput placeholder="Apelido do cartão" value={alias} onChangeText={setAlias} style={{ borderWidth: 1, padding: 10, borderRadius: 8 }} /><View style={{ flexDirection: "row", gap: 8 }}><TextInput placeholder="Fechamento (1-31)" keyboardType="number-pad" value={closing} onChangeText={setClosing} style={{ flex: 1, borderWidth: 1, padding: 10, borderRadius: 8 }} /><TextInput placeholder="Vencimento (1-31)" keyboardType="number-pad" value={due} onChangeText={setDue} style={{ flex: 1, borderWidth: 1, padding: 10, borderRadius: 8 }} /></View><Button label="Adicionar cartão" onPress={add} /></View><FlatList data={list} keyExtractor={(i) => i.id} renderItem={({ item }) => (<View style={{ flexDirection: "row", justifyContent: "space-between", padding: 10, borderWidth: 1, borderRadius: 8, marginTop: 6 }}><Text>{item.alias} — Fecha {item.closing_day} / Vence {item.due_day}</Text></View>)} /></View>); }
